# -*- coding: utf-8 -*-
# Part of Odoo. See LICENSE file for full copyright and licensing details.
import logging
_logger = logging.getLogger(__name__)

dian_countries_codes = {
    "AFGANISTAN": "13",
    "ALBANIA": "17",
    "ALEMANIA": "23",
    "ARMENIA": "26",
    "ARUBA": "27",
    "BOSNIA-HERZEGOVINA": "29",
    "BURKINA FASSO": "31",
    "ANDORRA": "37",
    "ANGOLA": "40",
    "ANGUILLA": "41",
    "ANTIGUA Y BARBUDA": "43",
    "ANTILLAS HOLANDESAS": "47",
    "ARABIA SAUDITA": "53",
    "ARGELIA": "59",
    "ARGENTINA": "63",
    "AUSTRALIA": "69",
    "AUSTRIA": "72",
    "AZERBAIJAN": "74",
    "BAHAMAS": "77",
    "BAHREIN": "80",
    "BANGLADESH": "81",
    "BARBADOS": "83",
    "BELGICA": "87",
    "BELICE": "88",
    "BERMUDAS": "90",
    "BELARUS": "91",
    "BIRMANIA (MYANMAR)": "93",
    "BOLIVIA": "97",
    "BOTSWANA": "101",
    "BRASIL": "105",
    "BRUNEI DARUSSALAM": "108",
    "BULGARIA": "111",
    "BURUNDI": "115",
    "BUTAN": "119",
    "CABO VERDE": "127",
    "CAIMAN, ISLAS": "137",
    "CAMBOYA (KAMPUCHEA)": "141",
    "CAMERUN, REPUBLICA UNIDA DEL": "145",
    "CANADA": "149",
    "SANTA SEDE": "159",
    "COCOS (KEELING), ISLAS": "165",
    "COLOMBIA": "169",
    "COMORAS": "173",
    "CONGO": "177",
    "COOK, ISLAS": "183",
    "COREA (NORTE), REPUBLICA POPULAR DEMOCRATICA DE": "187",
    "COREA (SUR), REPUBLICA DE": "190",
    "COSTA DE MARFIL": "193",
    "COSTA RICA": "196",
    "CROACIA": "198",
    "CUBA": "199",
    "CHAD": "203",
    "CHILE": "211",
    "CHINA": "215",
    "TAIWAN (FORMOSA)": "218",
    "CHIPRE": "221",
    "BENIN": "229",
    "DINAMARCA": "232",
    "DOMINICA": "235",
    "ECUADOR": "239",
    "EGIPTO": "240",
    "EL SALVADOR": "242",
    "ERITREA": "243",
    "EMIRATOS ARABES UNIDOS": "244",
    "ESPAÑA": "245",
    "ESLOVAQUIA": "246",
    "ESLOVENIA": "247",
    "ESTADOS UNIDOS": "249",
    "ESTONIA": "251",
    "ETIOPIA": "253",
    "FEROE, ISLAS": "259",
    "FILIPINAS": "267",
    "FINLANDIA": "271",
    "FRANCIA": "275",
    "GABON": "281",
    "GAMBIA": "285",
    "GEORGIA": "287",
    "GHANA": "289",
    "GIBRALTAR": "293",
    "GRANADA": "297",
    "GRECIA": "301",
    "GROENLANDIA": "305",
    "GUADALUPE": "309",
    "GUAM": "313",
    "GUATEMALA": "317",
    "GUAYANA FRANCESA": "325",
    "GUINEA": "329",
    "GUINEA ECUATORIAL": "331",
    "GUINEA-BISSAU": "334",
    "GUYANA": "337",
    "HAITI": "341",
    "HONDURAS": "345",
    "HONG KONG": "351",
    "HUNGRIA": "355",
    "INDIA": "361",
    "INDONESIA": "365",
    "IRAK": "369",
    "IRAN, REPUBLICA ISLAMICA DEL": "372",
    "IRLANDA (EIRE)": "375",
    "ISLANDIA": "379",
    "ISRAEL": "383",
    "ITALIA": "386",
    "JAMAICA": "391",
    "JAPON": "399",
    "JORDANIA": "403",
    "KAZAJSTAN": "406",
    "KENIA": "410",
    "KIRIBATI": "411",
    "KIRGUIZISTAN": "412",
    "KUWAIT": "413",
    "LAOS, REPUBLICA POPULAR DEMOCRATICA DE": "420",
    "LESOTHO": "426",
    "LETONIA": "429",
    "LIBANO": "431",
    "LIBERIA": "434",
    "LIBIA (INCLUYE FEZZAN)": "438",
    "LIECHTENSTEIN": "440",
    "LITUANIA": "443",
    "LUXEMBURGO": "445",
    "MACAO": "447",
    "MACEDONIA": "448",
    "MADAGASCAR": "450",
    "MALAYSIA": "455",
    "MALAWI": "458",
    "MALDIVAS": "461",
    "MALI": "464",
    "MALTA": "467",
    "MARIANAS DEL NORTE, ISLAS": "469",
    "MARSHALL, ISLAS": "472",
    "MARRUECOS": "474",
    "MARTINICA": "477",
    "MAURICIO": "485",
    "MAURITANIA": "488",
    "MEXICO": "493",
    "MICRONESIA, ESTADOS FEDERADOS DE": "494",
    "MOLDAVIA": "496",
    "MONGOLIA": "497",
    "MONACO": "498",
    "MONSERRAT, ISLA": "501",
    "MOZAMBIQUE": "505",
    "NAMIBIA": "507",
    "NAURU": "508",
    "NAVIDAD (CHRISTMAS), ISLAS": "511",
    "NEPAL": "517",
    "NICARAGUA": "521",
    "NIGER": "525",
    "NIGERIA": "528",
    "NIUE, ISLA": "531",
    "NORFOLK, ISLA": "535",
    "NORUEGA": "538",
    "NUEVA CALEDONIA": "542",
    "PAPUASIA NUEVA GUINEA": "545",
    "NUEVA ZELANDIA": "548",
    "VANUATU": "551",
    "OMAN": "556",
    "PACIFICO, ISLAS (USA)": "566",
    "PAISES BAJOS (HOLANDA)": "573",
    "PAKISTAN": "576",
    "PALAU, ISLAS": "578",
    "PANAMA": "580",
    "PARAGUAY": "586",
    "PERU": "589",
    "PITCAIRN, ISLA": "593",
    "POLINESIA FRANCESA": "599",
    "POLONIA": "603",
    "PORTUGAL": "607",
    "PUERTO RICO": "611",
    "QATAR": "618",
    "REINO UNIDO": "628",
    "REPUBLICA CENTROAFRICANA": "640",
    "REPUBLICA CHECA": "644",
    "REPUBLICA DOMINICANA": "647",
    "REUNION": "660",
    "ZIMBABWE": "665",
    "RUMANIA": "670",
    "RUANDA": "675",
    "RUSIA": "676",
    "SALOMON, ISLAS": "677",
    "SAHARA OCCIDENTAL": "685",
    "SAMOA": "687",
    "SAMOA NORTEAMERICANA": "690",
    "SAN CRISTOBAL Y NIEVES": "695",
    "SAN MARINO": "697",
    "SAN PEDRO Y MIGUELON": "700",
    "SAN VICENTE Y LAS GRANADINAS": "705",
    "SANTA ELENA": "710",
    "SANTA LUCIA": "715",
    "SANTO TOME Y PRINCIPE": "720",
    "SENEGAL": "728",
    "SEYCHELLES": "731",
    "SIERRA LEONA": "735",
    "SINGAPUR": "741",
    "SIRIA, REPUBLICA ARABE DE": "744",
    "SOMALIA": "748",
    "SRI LANKA": "750",
    "SUDAFRICA, REPUBLICA DE": "756",
    "SUDAN": "759",
    "SUECIA": "764",
    "SUIZA": "767",
    "SURINAM": "770",
    "SWAZILANDIA": "773",
    "TADJIKISTAN": "774",
    "TAILANDIA": "776",
    "TANZANIA, REPUBLICA UNIDA DE": "780",
    "DJIBOUTI": "783",
    "TERRITORIO BRITANICO DEL OCEANO INDICO": "787"
}

dian_department_codes = {
    'Antioquia': '05', 
    'Atlántico': '08', 
    'Bogotá': '11', 
    'Bolívar': '13', 
    'Boyacá': '15', 
    'Caldas': '17', 
    'Caquetá': '18', 
    'Cauca': '19',
    'Cesar': '20',
    'Córdoba': '23',
    'Cundinamarca': '25',
    'Chocó': '27',
    'Huila': '41',
    'La Guajira': '44',
    'Magdalena': '47',
    'Meta': '50',
    'Nariño': '52',
    'Norte de Santander': '54',
    'Quindío': '63',
    'Risaralda': '66',
    'Santander': '68',
    'Sucre': '70',
    'Tolima': '73',
    'Valle del Cauca': '76',
    'Arauca': '81',
    'Casanare': '85',
    'Putumayo': '86',
    'San Andrés y Providencia': '88',
    'Amazonas': '91',
    'Guainía': '94',
    'Guaviare': '95',
    'Vaupés': '97',
    'Vichada': '99'
}

dian_cities_by_department = {
    "Amazonas": {
            "Leticia": "91001",
            "El Encanto": "91263",
            "La Chorrera": "91405",
            "La Pedrera": "91407",
            "La Victoria": "76403",
            "Miriti – Paraná": "91460",
            "Puerto Alegría": "91530",
            "Puerto Arica": "91536",
            "Puerto Nariño": "91540",
            "Puerto Santander": "54553",
            "Tarapacá": "91798"
    },
    "Antioquia":{
        "Medellín": "5001",
        "Abejorral": "5002",
        "Abriaquí": "5004",
        "Alejandría": "5021",
        "Amagá": "5030",
        "Amalfi": "5031",
        "Andes": "5034",
        "Angelópolis": "5036",
        "Angostura": "5038",
        "Anorí": "5040",
        "Santafé De Antioquia": "5042",
        "Anza": "5044",
        "Apartadó": "5045",
        "Arboletes": "5051",
        "Argelia": "76054",
        "Armenia": "63001",
        "Barbosa": "68077",
        "Belmira": "5086",
        "Bello": "5088",
        "Betania": "5091",
        "Betulia": "68092",
        "Ciudad Bolívar": "5101",
        "Briceño": "15106",
        "Buriticá": "5113",
        "Cáceres": "5120",
        "Caicedo": "5125",
        "Caldas": "15131",
        "Campamento": "5134",
        "Cañasgordas": "5138",
        "Caracolí": "5142",
        "Caramanta": "5145",
        "Carepa": "5147",
        "El Carmen De Viboral": "5148",
        "Carolina": "5150",
        "Caucasia": "5154",
        "Chigorodó": "5172",
        "Cisneros": "5190",
        "Cocorná": "5197",
        "Concepción": "68207",
        "Concordia": "47205",
        "Copacabana": "5212",
        "Dabeiba": "5234",
        "Donmatías": "5237",
        "Ebéjico": "5240",
        "El Bagre": "5250",
        "Entrerrios": "5264",
        "Envigado": "5266",
        "Fredonia": "5282",
        "Frontino": "5284",
        "Giraldo": "5306",
        "Girardota": "5308",
        "Gómez Plata": "5310",
        "Granada": "50313",
        "Guadalupe": "68320",
        "Guarne": "5318",
        "Guatape": "5321",
        "Heliconia": "5347",
        "Hispania": "5353",
        "Itagui": "5360",
        "Ituango": "5361",
        "Jardín": "5364",
        "Jericó": "15368",
        "La Ceja": "5376",
        "La Estrella": "5380",
        "La Pintada": "5390",
        "La Unión": "76400",
        "Liborina": "5411",
        "Maceo": "5425",
        "Marinilla": "5440",
        "Montebello": "5467",
        "Murindó": "5475",
        "Mutatá": "5480",
        "Nariño": "52480",
        "Necoclí": "5490",
        "Nechí": "5495",
        "Olaya": "5501",
        "Peñol": "5541",
        "Peque": "5543",
        "Pueblorrico": "5576",
        "Puerto Berrío": "5579",
        "Puerto Nare": "5585",
        "Puerto Triunfo": "5591",
        "Remedios": "5604",
        "Retiro": "5607",
        "Rionegro": "68615",
        "Sabanalarga": "85300",
        "Sabaneta": "5631",
        "Salgar": "5642",
        "San Andrés De Cuerquía": "5647",
        "San Carlos": "23678",
        "San Francisco": "86755",
        "San Jerónimo": "5656",
        "San José De La Montaña": "5658",
        "San Juan De Urabá": "5659",
        "San Luis": "73678",
        "San Pedro De Los Milagros": "5664",
        "San Pedro De Uraba": "5665",
        "San Rafael": "5667",
        "San Roque": "5670",
        "San Vicente": "5674",
        "Santa Bárbara": "68705",
        "Santa Rosa De Osos": "5686",
        "Santo Domingo": "5690",
        "El Santuario": "5697",
        "Segovia": "5736",
        "Sonson": "5756",
        "Sopetrán": "5761",
        "Támesis": "5789",
        "Tarazá": "5790",
        "Tarso": "5792",
        "Titiribí": "5809",
        "Toledo": "54820",
        "Turbo": "5837",
        "Uramita": "5842",
        "Urrao": "5847",
        "Valdivia": "5854",
        "Valparaíso": "18860",
        "Vegachí": "5858",
        "Venecia": "25506",
        "Vigía Del Fuerte": "5873",
        "Yalí": "5885",
        "Yarumal": "5887",
        "Yolombó": "5890",
        "Yondó": "5893",
        "Zaragoza": "5895"
    },
    "Arauca":{
        "Arauca": "81001",
        "Arauquita": "81065",
        "Cravo Norte": "81220",
        "Fortul": "81300",
        "Puerto Rondón": "81591",
        "Saravena": "81736",
        "Tame": "81794"
    },
    "Atlántico":{
        "Barranquilla": "8001",
        "Baranoa": "8078",
        "Campo De La Cruz": "8137",
        "Candelaria": "76130",
        "Galapa": "8296",
        "Juan De Acosta": "8372",
        "Luruaco": "8421",
        "Malambo": "8433",
        "Manatí": "8436",
        "Palmar De Varela": "8520",
        "Piojó": "8549",
        "Polonuevo": "8558",
        "Ponedera": "8560",
        "Puerto Colombia": "94884",
        "Repelón": "8606",
        "Sabanagrande": "8634",
        "Santa Lucía": "8675",
        "Santo Tomás": "8685",
        "Soledad": "8758",
        "Suan": "8770",
        "Tubará": "8832",
        "Usiacurí": "8849"
    },
    "Bogotá":{
        "Bogotá D.C.": "11001"
    },
    "Bolívar":{
        "Cartagena": "13001",
        "Achí": "13006",
        "Altos Del Rosario": "13030",
        "Arenal": "13042",
        "Arjona": "13052",
        "Arroyohondo": "13062",
        "Barranco De Loba": "13074",
        "Calamar": "95015",
        "Cantagallo": "13160",
        "Cicuco": "13188",
        "Córdoba": "63212",
        "Clemencia": "13222",
        "El Carmen De Bolívar": "13244",
        "El Guamo": "13248",
        "El Peñón": "68250",
        "Hatillo De Loba": "13300",
        "Magangué": "13430",
        "Mahates": "13433",
        "Margarita": "13440",
        "María La Baja": "13442",
        "Montecristo": "13458",
        "Mompós": "13468",
        "Morales": "19473",
        "Norosí": "13490",
        "Pinillos": "13549",
        "Regidor": "13580",
        "Río Viejo": "13600",
        "San Cristóbal": "13620",
        "San Estanislao": "13647",
        "San Fernando": "13650",
        "San Jacinto": "13654",
        "San Jacinto Del Cauca": "13655",
        "San Juan Nepomuceno": "13657",
        "San Martín De Loba": "13667",
        "San Pablo": "52693",
        "Santa Catalina": "13673",
        "Santa Rosa": "19701",
        "Santa Rosa Del Sur": "13688",
        "Simití": "13744",
        "Soplaviento": "13760",
        "Talaigua Nuevo": "13780",
        "Tiquisio": "13810",
        "Turbaco": "13836",
        "Turbaná": "13838",
        "Villanueva": "68872",
        "Zambrano": "13894"
    },
    "Boyacá":{
        "Tunja": "15001",
        "Almeida": "15022",
        "Aquitania": "15047",
        "Arcabuco": "15051",
        "Belén": "52083",
        "Berbeo": "15090",
        "Betéitiva": "15092",
        "Boavita": "15097",
        "Boyacá": "15104",
        "Buenavista": "70110",
        "Busbanzá": "15114",
        "Campohermoso": "15135",
        "Cerinza": "15162",
        "Chinavita": "15172",
        "Chiquinquirá": "15176",
        "Chiscas": "15180",
        "Chita": "15183",
        "Chitaraque": "15185",
        "Chivatá": "15187",
        "Ciénega": "15189",
        "Cómbita": "15204",
        "Coper": "15212",
        "Corrales": "15215",
        "Covarachía": "15218",
        "Cubará": "15223",
        "Cucaita": "15224",
        "Cuítiva": "15226",
        "Chíquiza": "15232",
        "Chivor": "15236",
        "Duitama": "15238",
        "El Cocuy": "15244",
        "El Espino": "15248",
        "Firavitoba": "15272",
        "Floresta": "15276",
        "Gachantivá": "15293",
        "Gameza": "15296",
        "Garagoa": "15299",
        "Guacamayas": "15317",
        "Guateque": "15322",
        "Guayatá": "15325",
        "Güicán": "15332",
        "Iza": "15362",
        "Jenesano": "15367",
        "Labranzagrande": "15377",
        "La Capilla": "15380",
        "La Uvita": "15403",
        "Villa De Leyva": "15407",
        "Macanal": "15425",
        "Maripí": "15442",
        "Miraflores": "95200",
        "Mongua": "15464",
        "Monguí": "15466",
        "Moniquirá": "15469",
        "Motavita": "15476",
        "Muzo": "15480",
        "Nobsa": "15491",
        "Nuevo Colón": "15494",
        "Oicatá": "15500",
        "Otanche": "15507",
        "Pachavita": "15511",
        "Páez": "15514",
        "Paipa": "15516",
        "Pajarito": "15518",
        "Panqueba": "15522",
        "Pauna": "15531",
        "Paya": "15533",
        "Paz De Río": "15537",
        "Pesca": "15542",
        "Pisba": "15550",
        "Puerto Boyacá": "15572",
        "Quípama": "15580",
        "Ramiriquí": "15599",
        "Ráquira": "15600",
        "Rondón": "15621",
        "Saboyá": "15632",
        "Sáchica": "15638",
        "Samacá": "15646",
        "San Eduardo": "15660",
        "San José De Pare": "15664",
        "San Luis De Gaceno": "15667",
        "San Mateo": "15673",
        "San Miguel De Sema": "15676",
        "San Pablo De Borbur": "15681",
        "Santana": "15686",
        "Santa María": "41676",
        "Santa Rosa De Viterbo": "15693",
        "Santa Sofía": "15696",
        "Sativanorte": "15720",
        "Sativasur": "15723",
        "Siachoque": "15740",
        "Soatá": "15753",
        "Socotá": "15755",
        "Socha": "15757",
        "Sogamoso": "15759",
        "Somondoco": "15761",
        "Sora": "15762",
        "Sotaquirá": "15763",
        "Soracá": "15764",
        "Susacón": "15774",
        "Sutamarchán": "15776",
        "Sutatenza": "15778",
        "Tasco": "15790",
        "Tenza": "15798",
        "Tibaná": "15804",
        "Tibasosa": "15806",
        "Tinjacá": "15808",
        "Tipacoque": "15810",
        "Toca": "15814",
        "Togüí": "15816",
        "Tópaga": "15820",
        "Tota": "15822",
        "Tununguá": "15832",
        "Turmequé": "15835",
        "Tuta": "15837",
        "Tutazá": "15839",
        "Umbita": "15842",
        "Ventaquemada": "15861",
        "Viracachá": "15879",
        "Zetaquira": "15897"
    },
    "Caldas":{
        "Manizales": "17001",
        "Aguadas": "17013",
        "Anserma": "17042",
        "Aranzazu": "17050",
        "Belalcázar": "17088",
        "Chinchiná": "17174",
        "Filadelfia": "17272",
        "La Dorada": "17380",
        "La Merced": "17388",
        "Manzanares": "17433",
        "Marmato": "17442",
        "Marquetalia": "17444",
        "Marulanda": "17446",
        "Neira": "17486",
        "Norcasia": "17495",
        "Pácora": "17513",
        "Palestina": "41530",
        "Pensilvania": "17541",
        "Riosucio": "27615",
        "Risaralda": "17616",
        "Salamina": "47675",
        "Samaná": "17662",
        "San José": "17665",
        "Supía": "17777",
        "Victoria": "17867",
        "Villamaría": "17873",
        "Viterbo": "17877"
    },
    "Caquetá":{
        "Florencia": "18001",
        "Albania": "18029",
        "Belén De Los Andaquíes": "18094",
        "Cartagena Del Chairá": "18150",
        "Curillo": "18205",
        "El Doncello": "18247",
        "El Paujil": "18256",
        "La Montañita": "18410",
        "Milán": "18460",
        "Morelia": "18479",
        "Puerto Rico": "50590",
        "San José Del Fragua": "18610",
        "San Vicente Del Caguán": "18753",
        "Solano": "18756",
        "Solita": "18785",
        "Valparaíso": "18860"
    },
    "Casanare":{
        "Yopal": "85001",
        "Aguazul": "85010",
        "Chameza": "85015",
        "Hato Corozal": "85125",
        "La Salina": "85136",
        "Maní": "85139",
        "Monterrey": "85162",
        "Nunchía": "85225",
        "Orocué": "85230",
        "Paz De Ariporo": "85250",
        "Pore": "85263",
        "Recetor": "85279",
        "Sácama": "85315",
        "San Luis De Palenque": "85325",
        "Támara": "85400",
        "Tauramena": "85410",
        "Trinidad": "85430",
        "Villanueva": "85440"
    },
    "Cauca":{
        "Popayán": "19001",
        "Almaguer": "19022",
        "Balboa": "66075",
        "Bolívar": "76100",
        "Buenos Aires": "19110",
        "Cajibío": "19130",
        "Caldono": "19137",
        "Caloto": "19142",
        "Corinto": "19212",
        "El Tambo": "52260",
        "Guachené": "19300",
        "Guapi": "19318",
        "Inzá": "19355",
        "Jambaló": "19364",
        "La Sierra": "19392",
        "La Vega": "25402",
        "López": "19418",
        "Mercaderes": "19450",
        "Miranda": "19455",
        "Padilla": "19513",
        "Paez": "19517",
        "Patía": "19532",
        "Piamonte": "19533",
        "Piendamó": "19548",
        "Puerto Tejada": "19573",
        "Puracé": "19585",
        "Rosas": "19622",
        "San Sebastián": "19693",
        "Santander De Quilichao": "19698",
        "Silvia": "19743",
        "Sotara": "19760",
        "Suárez": "73770",
        "Sucre": "70771",
        "Timbío": "19807",
        "Timbiquí": "19809",
        "Toribio": "19821",
        "Totoró": "19824",
        "Villa Rica": "19845"
    },
    "Cesar":{
        "Valledupar": "20001",
        "Aguachica": "20011",
        "Agustín Codazzi": "20013",
        "Astrea": "20032",
        "Becerril": "20045",
        "Bosconia": "20060",
        "Chimichagua": "20175",
        "Chiriguaná": "20178",
        "Curumaní": "20228",
        "El Copey": "20238",
        "El Paso": "20250",
        "Gamarra": "20295",
        "González": "20310",
        "La Gloria": "20383",
        "La Jagua De Ibirico": "20400",
        "Manaure": "44560",
        "Pailitas": "20517",
        "Pelaya": "20550",
        "Pueblo Bello": "20570",
        "Río De Oro": "20614",
        "La Paz": "68397",
        "San Alberto": "20710",
        "San Diego": "20750",
        "San Martín": "50689",
        "Tamalameque": "20787"
    },
    "Chocó":{
        "Quibdó": "27001",
        "Acandí": "27006",
        "Alto Baudó": "27025",
        "Atrato": "27050",
        "Bagadó": "27073",
        "Bahía Solano": "27075",
        "Bajo Baudó": "27077",
        "Bojaya": "27099",
        "El Cantón Del San Pablo": "27135",
        "Carmen Del Darién": "27150",
        "Cértegui": "27160",
        "Condoto": "27205",
        "El Carmen De Atrato": "27245",
        "El Litoral Del San Juan": "27250",
        "Istmina": "27361",
        "Juradó": "27372",
        "Lloró": "27413",
        "Medio Atrato": "27425",
        "Medio Baudó": "27430",
        "Medio San Juan": "27450",
        "Nóvita": "27491",
        "Nuquí": "27495",
        "Río Iró": "27580",
        "Río Quito": "27600",
        "San José Del Palmar": "27660",
        "Sipí": "27745",
        "Tadó": "27787",
        "Unguía": "27800",
        "Unión Panamericana": "27810"
    },
    "Córdoba":{
        "Montería": "23001",
        "Ayapel": "23068",
        "Canalete": "23090",
        "Cereté": "23162",
        "Chimá": "23168",
        "Chinú": "23182",
        "Ciénaga De Oro": "23189",
        "Cotorra": "23300",
        "La Apartada": "23350",
        "Lorica": "23417",
        "Los Córdobas": "23419",
        "Momil": "23464",
        "Montelíbano": "23466",
        "Moñitos": "23500",
        "Planeta Rica": "23555",
        "Pueblo Nuevo": "23570",
        "Puerto Escondido": "23574",
        "Puerto Libertador": "23580",
        "Purísima": "23586",
        "Sahagún": "23660",
        "San Andrés Sotavento": "23670",
        "San Antero": "23672",
        "San Bernardo Del Viento": "23675",
        "San José De Uré": "23682",
        "San Pelayo": "23686",
        "Tierralta": "23807",
        "Tuchín": "23815",
        "Valencia": "23855"
    },
    "Cundinamarca":{
        "Agua De Dios": "25001",
        "Albán": "52019",
        "Anapoima": "25035",
        "Anolaima": "25040",
        "Arbeláez": "25053",
        "Beltrán": "25086",
        "Bituima": "25095",
        "Bojacá": "25099",
        "Cabrera": "68121",
        "Cachipay": "25123",
        "Cajicá": "25126",
        "Caparrapí": "25148",
        "Caqueza": "25151",
        "Carmen De Carupa": "25154",
        "Chaguaní": "25168",
        "Chía": "25175",
        "Chipaque": "25178",
        "Choachí": "25181",
        "Chocontá": "25183",
        "Cogua": "25200",
        "Cota": "25214",
        "Cucunubá": "25224",
        "El Colegio": "25245",
        "El Rosal": "25260",
        "Facatativá": "25269",
        "Fomeque": "25279",
        "Fosca": "25281",
        "Funza": "25286",
        "Fúquene": "25288",
        "Fusagasugá": "25290",
        "Gachala": "25293",
        "Gachancipá": "25295",
        "Gachetá": "25297",
        "Gama": "25299",
        "Girardot": "25307",
        "Guachetá": "25317",
        "Guaduas": "25320",
        "Guasca": "25322",
        "Guataquí": "25324",
        "Guatavita": "25326",
        "Guayabal De Siquima": "25328",
        "Guayabetal": "25335",
        "Gutiérrez": "25339",
        "Jerusalén": "25368",
        "Junín": "25372",
        "La Calera": "25377",
        "La Mesa": "25386",
        "La Palma": "25394",
        "La Peña": "25398",
        "Lenguazaque": "25407",
        "Macheta": "25426",
        "Madrid": "25430",
        "Manta": "25436",
        "Medina": "25438",
        "Mosquera": "52473",
        "Nemocón": "25486",
        "Nilo": "25488",
        "Nimaima": "25489",
        "Nocaima": "25491",
        "Pacho": "25513",
        "Paime": "25518",
        "Pandi": "25524",
        "Paratebueno": "25530",
        "Pasca": "25535",
        "Puerto Salgar": "25572",
        "Pulí": "25580",
        "Quebradanegra": "25592",
        "Quetame": "25594",
        "Quipile": "25596",
        "Apulo": "25599",
        "Ricaurte": "52612",
        "San Antonio Del Tequendama": "25645",
        "San Bernardo": "52685",
        "San Cayetano": "54673",
        "San Juan De Río Seco": "25662",
        "Sasaima": "25718",
        "Sesquilé": "25736",
        "Sibaté": "25740",
        "Silvania": "25743",
        "Simijaca": "25745",
        "Soacha": "25754",
        "Sopó": "25758",
        "Subachoque": "25769",
        "Suesca": "25772",
        "Supatá": "25777",
        "Susa": "25779",
        "Sutatausa": "25781",
        "Tabio": "25785",
        "Tausa": "25793",
        "Tena": "25797",
        "Tenjo": "25799",
        "Tibacuy": "25805",
        "Tibirita": "25807",
        "Tocaima": "25815",
        "Tocancipá": "25817",
        "Topaipí": "25823",
        "Ubalá": "25839",
        "Ubaque": "25841",
        "Villa De San Diego De Ubate": "25843",
        "Une": "25845",
        "Útica": "25851",
        "Vergara": "25862",
        "Vianí": "25867",
        "Villagómez": "25871",
        "Villapinzón": "25873",
        "Villeta": "25875",
        "Viotá": "25878",
        "Yacopí": "25885",
        "Zipacón": "25898",
        "Zipaquirá": "25899"
    },
    "Guainía":{
        "Inírida": "94001",
        "Barranco Minas": "94343",
        "Mapiripana": "94663",
        "San Felipe": "94883",
        "La Guadalupe": "94885",
        "Cacahual": "94886",
        "Pana Pana": "94887",
        "Morichal": "94888"
    },
    "Guaviare":{
        "San José Del Guaviare": "95001",
        "Calamar": "95015",
        "El Retorno": "95025",
        "Miraflores": "95074"
    },
    "Huila":{
        "Neiva": "41001",
        "Acevedo": "41006",
        "Agrado": "41013",
        "Aipe": "41016",
        "Algeciras": "41020",
        "Altamira": "41026",
        "Baraya": "41078",
        "Campoalegre": "41132",
        "Colombia": "41206",
        "Elías": "41244",
        "Garzón": "41298",
        "Gigante": "41306",
        "Hobo": "41349",
        "Iquira": "41357",
        "Isnos": "41359",
        "La Argentina": "41378",
        "La Plata": "41396",
        "Nátaga": "41483",
        "Oporapa": "41503",
        "Paicol": "41518",
        "Palermo": "41524",
        "Pital": "41548",
        "Pitalito": "41551",
        "Rivera": "41615",
        "Saladoblanco": "41660",
        "San Agustín": "41668",
        "Suaza": "41770",
        "Tarqui": "41791",
        "Tesalia": "41797",
        "Tello": "41799",
        "Teruel": "41801",
        "Timaná": "41807",
        "Villavieja": "41872",
        "Yaguará": "41885"
    },
    "La Guajira":{
        "Riohacha": "44001",
        "Albania": "44035",
        "Barrancas": "44078",
        "Dibulla": "44090",
        "Distracción": "44098",
        "El Molino": "44110",
        "Fonseca": "44279",
        "Hatonuevo": "44378",
        "La Jagua Del Pilar": "44420",
        "Maicao": "44430",
        "Manaure": "44560",
        "San Juan Del Cesar": "44650",
        "Uribia": "44847",
        "Urumita": "44855",
        "Villanueva": "44874"
    },
    "Magdalena":{
        "Santa Marta": "47001",
        "Algarrobo": "47030",
        "Aracataca": "47053",
        "Ariguaní": "47058",
        "Cerro San Antonio": "47161",
        "Chibolo": "47170",
        "Ciénaga": "47189",
        "Concordia": "47205",
        "El Banco": "47245",
        "El Piñón": "47258",
        "El Retén": "47268",
        "Fundación": "47288",
        "Guamal": "47318",
        "Nueva Granada": "47460",
        "Pedraza": "47541",
        "Pijiño Del Carmen": "47545",
        "Pivijay": "47551",
        "Plato": "47555",
        "Puebloviejo": "47570",
        "Remolino": "47605",
        "Sabanas De San Angel": "47660",
        "Salamina": "47675",
        "San Sebastián De Buenavista": "47692",
        "San Zenón": "47703",
        "Santa Ana": "47707",
        "Santa Bárbara De Pinto": "47720",
        "Sitionuevo": "47798",
        "Tenerife": "47798",
        "Zapayán": "47960",
        "Zona Bananera": "47980"
    },
    "Meta":{    
        "Villavicencio": "50001",
        "Acacías": "50006",
        "Barranca De Upía": "50110",
        "Cabuyaro": "50124",
        "Castilla La Nueva": "50150",
        "Cubarral": "50223",
        "Cumaral": "50226",
        "El Calvario": "50245",
        "El Castillo": "50251",
        "El Dorado": "50270",
        "Fuente De Oro": "50287",
        "Mapiripán": "50325",
        "Mesetas": "50330",
        "La Macarena": "50350",
        "Uribe": "50370",
        "Lejanías": "50400",
        "Puerto Concordia": "50450",
        "Puerto Gaitán": "50568",
        "Puerto López": "50573",
        "Puerto Lleras": "50577",
        "Restrepo": "76606",
        "San Carlos De Guaroa": "50680",
        "San Juan De Arama": "50683",
        "San Juanito": "50686",
        "Vistahermosa": "50711"
    },
    "Nariño":{
        "Pasto": "52001",
        "Aldana": "52022",
        "Ancuyá": "52036",
        "Arboleda": "52051",
        "Barbacoas": "52079",
        "Buesaco": "52110",
        "Colón": "86219",
        "Consaca": "52207",
        "Contadero": "52210",
        "Cuaspud": "52224",
        "Cumbal": "52227",
        "Cumbitara": "52233",
        "Chachagüí": "52240",
        "El Charco": "52250",
        "El Peñol": "52254",
        "El Rosario": "52256",
        "El Tablón De Gómez": "52258",
        "Funes": "52287",
        "Guachucal": "52317",
        "Guaitarilla": "52320",
        "Gualmatán": "52323",
        "Iles": "52352",
        "Imués": "52354",
        "Ipiales": "52356",
        "La Cruz": "52378",
        "La Florida": "52381",
        "La Llanada": "52385",
        "La Tola": "52390",
        "Leiva": "52405",
        "Linares": "52411",
        "Los Andes": "52418",
        "Magüi": "52427",
        "Mallama": "52435",
        "Olaya Herrera": "52490",
        "Ospina": "52506",
        "Francisco Pizarro": "52520",
        "Policarpa": "52540",
        "Potosí": "52560",
        "Providencia": "88564",
        "Puerres": "52573",
        "Pupiales": "52585",
        "Roberto Payán": "52621",
        "Samaniego": "52678",
        "Sandoná": "52683",
        "San Lorenzo": "52687",
        "San Pedro De Cartago": "52694",
        "Santacruz": "52699",
        "Sapuyes": "52720",
        "Taminango": "52786"
    },
    "Norte de Santander":{
        "Cúcuta": "54001",
        "Abrego": "54003",
        "Arboledas": "54051",
        "Bochalema": "54099",
        "Bucarasica": "54109",
        "Cácota": "54125",
        "Cachirá": "54128",
        "Chinácota": "54172",
        "Chitagá": "54174",
        "Convención": "54206",
        "Cucutilla": "54223",
        "Durania": "54239",
        "El Carmen": "54245",
        "El Tarra": "54250",
        "El Zulia": "54261",
        "Gramalote": "54313",
        "Hacarí": "54344",
        "Herrán": "54347",
        "Labateca": "54377",
        "La Esperanza": "54385",
        "La Playa": "54398",
        "Los Patios": "54405",
        "Lourdes": "54418",
        "Mutiscua": "54480",
        "Ocaña": "54498",
        "Pamplona": "54518",
        "Pamplonita": "54520",
        "Ragonvalia": "54599",
        "Salazar": "54660",
        "San Calixto": "54670",
        "Santiago": "86760",
        "Sardinata": "54720",
        "Silos": "54743",
        "Teorama": "54800",
        "Tibú": "54810",
        "Villa Caro": "54871",
        "Villa Del Rosario": "54874"
    },
    "Putumayo":{
        "Mocoa": "86001",
        "Colón": "86320",
        "Orito": "86320",
        "Puerto Asís": "86568",
        "Puerto Caicedo": "86569",
        "Puerto Guzmán": "86571",
        "Leguízamo": "86573",
        "Sibundoy": "86749",
        "San Francisco": "86755",
        "San Miguel": "86757",
        "Santiago": "86760",
        "Valle Del Guamuez": "86865",
        "Villagarzón": "86885"
    },
    "Quindío":{
        "Calarca": "63130",
        "Circasia": "63190",
        "Córdoba": "63212",
        "Filandia": "63272",
        "Génova": "63302",
        "La Tebaida": "63401",
        "Montenegro": "63470",
        "Pijao": "63548",
        "Quimbaya": "63594",
        "Salento": "63690"
    },
    "Risaralda":{
        "Pereira": "66001",
        "Apía": "66045",
        "Balboa": "66075",
        "Belén De Umbría": "66088",
        "Dosquebradas": "66170",
        "Guática": "66318",
        "La Celia": "66383",
        "La Virginia": "66400",
        "Marsella": "66440",
        "Mistrató": "66456",
        "Pueblo Rico": "66572",
        "Quinchía": "66594",
        "Santa Rosa De Cabal": "66682",
        "Santuario": "66687"
    },
    "San Andrés y Providencia":{
        "San Andrés": "88001",
        "Providencia": "88564"
    },
    "Santander":{
        "Bucaramanga": "68001",
        "Aguada": "68013",
        "Albania": "68020",
        "Aratoca": "68051",
        "Barbosa": "68077",
        "Barichara": "68079",
        "Barrancabermeja": "68081",
        "Betulia": "68092",
        "Bolívar": "68101",
        "Cabrera": "68121",
        "California": "68132",
        "Capitanejo": "68147",
        "Carcasí": "68152",
        "Cepitá": "68160",
        "Cerrito": "68162",
        "Charalá": "68167",
        "Charta": "68169",
        "Chima": "68176",
        "Chipatá": "68179",
        "Cimitarra": "68190",
        "Concepción": "68207",
        "Confines": "68209",
        "Contratación": "68211",
        "Coromoro": "68217",
        "Curití": "68229",
        "El Carmen De Chucurí": "68235",
        "El Guacamayo": "68245",
        "El Peñón": "68250",
        "El Playón": "68255",
        "Encino": "68264",
        "Enciso": "68266",
        "Florián": "68271",
        "Floridablanca": "68276",
        "Galán": "68296",
        "Gambita": "68298",
        "Girón": "68307",
        "Guaca": "68318",
        "Guadalupe": "68320",
        "Guapota": "68322",
        "Guavatá": "68324",
        "Güepsa": "68327",
        "Hato": "68344",
        "Jesús María": "68368",
        "Jordán": "68370",
        "La Belleza": "68377",
        "Landázuri": "68385",
        "La Paz": "68397",
        "Lebrija": "68406",
        "Los Santos": "68418",
        "Macaravita": "68425",
        "Málaga": "68432",
        "Matanza": "68444",
        "Mogotes": "68464",
        "Molagavita": "68468",
        "Ocamonte": "68498",
        "Oiba": "68500",
        "Onzaga": "68502",
        "Palmar": "68522",
        "Palmas Del Socorro": "68524",
        "Páramo": "68533",
        "Piedecuesta": "68547",
        "Pinchote": "68549",
        "Puente Nacional": "68572",
        "Puerto Parra": "68573",
        "Puerto Wilches": "68575",
        "Sabana De Torres": "68655",
        "San Benito": "68673",
        "San Gil": "68679",
        "San Joaquín": "68682",
        "San José De Miranda": "68684",
        "San Vicente De Chucurí": "68689",
        "Santa Helena Del Opón": "68720",
        "Simacota": "68745",
        "Socorro": "68755",
        "Suaita": "68770",
        "Suratá": "68780",
        "Tona": "68820",
        "Valle De San José": "68855",
        "Vélez": "68861",
        "Vetas": "68867",
        "Zapatoca": "68895"
    },
    "Sucre":{
        "Sincelejo": "70001",
        "Buenavista": "70110",
        "Caimito": "70124",
        "Coloso": "70204",
        "Corozal": "70215",
        "Coveñas": "70221",
        "Chalán": "70230",
        "El Roble": "70233",
        "Galeras": "70235",
        "Guaranda": "70265",
        "La Unión": "70400",
        "Los Palmitos": "70418",
        "Majagual": "70429",
        "Morroa": "70473",
        "Ovejas": "70508",
        "Palmito": "70523",
        "Sampués": "70670",
        "San Benito Abad": "70678",
        "San Juan De Betulia": "70702",
        "San Marcos": "70708",
        "San Onofre": "70713",
        "San Pedro": "76670",
        "San Luis De Sincé": "70742",
        "Santiago De Tolú": "70820",
        "Tolú Viejo": "70823"
    },
    "Tolima":{
        "Ibagué": "73001",
        "Alpujarra": "73024",
        "Alvarado": "73026",
        "Ambalema": "73030",
        "Anzoátegui": "73043",
        "Armero": "73055",
        "Ataco": "73067",
        "Cajamarca": "73124",
        "Carmen De Apicalá": "73148",
        "Casabianca": "73152",
        "Chaparral": "73168",
        "Coello": "73200",
        "Coyaima": "73217",
        "Cunday": "73226",
        "Dolores": "73236",
        "Espinal": "73268",
        "Falan": "73270",
        "Flandes": "73275",
        "Fresno": "73283",
        "Guamo": "73319",
        "Herveo": "73347",
        "Honda": "73349",
        "Icononzo": "73352",
        "Lérida": "73408",
        "Líbano": "73411",
        "San Sebastián De Mariquita": "73443",
        "Melgar": "73449",
        "Murillo": "73461",
        "Natagaima": "73483",
        "Ortega": "73504",
        "Palocabildo": "73520",
        "Piedras": "73547",
        "Planadas": "73555",
        "Prado": "73563",
        "Purificación": "73585",
        "Rioblanco": "73616",
        "Roncesvalles": "73622",
        "Rovira": "73624",
        "Saldaña": "73671",
        "San Antonio": "73675",
        "Santa Isabel": "73686",
        "Valle De San Juan": "73854",
        "Venadillo": "73861",
        "Villahermosa": "73870",
        "Villarrica": "73873"
    },
    "Valle del Cauca":{
        "Cali": "76001",
        "Alcalá": "76020",
        "Andalucía": "76036",
        "Ansermanuevo": "76041",
        "Buenaventura": "76109",
        "Guadalajara De Buga": "76111",
        "Bugalagrande": "76113",
        "Caicedonia": "76122",
        "Calima": "76126",
        "Cartago": "76147",
        "Dagua": "76233",
        "El Águila": "76243",
        "El Cairo": "76246",
        "El Cerrito": "76248",
        "El Dovio": "76250",
        "Florida": "76275",
        "Ginebra": "76306",
        "Guacarí": "76318",
        "Jamundí": "76364",
        "La Cumbre": "76377",
        "Obando": "76497",
        "Palmira": "76520",
        "Pradera": "76563",
        "Riofrío": "76616",
        "Roldanillo": "76622",
        "Sevilla": "76736",
        "Toro": "76823",
        "Trujillo": "76828",
        "Tuluá": "76834",
        "Ulloa": "76845",
        "Versalles": "76863",
        "Vijes": "76869",
        "Yotoco": "76890",
        "Yumbo": "76892",
        "Zarzal": "76895"
    },
    "Vaupés":{
        "Mitú": "97001",
        "Caruru": "97161",
        "Pacoa": "97511",
        "Taraira": "97666",
        "Papunaua": "97777",
        "Yavaraté": "97889"
    },
    "Vichada":{
        "Puerto Carreño": "99001",
        "La Primavera": "99524",
        "Santa Rosalía": "99624",
        "Cumaribo": "99773"
    }
}




def _column_name_field(names, ws):
    letters = get_excel_column_letters(len(names))
    for index, name in enumerate(names, start=0):
        ws[f'{letters[index]}1'] = name
    return ws

def get_excel_column_letters(num_columns) -> list:
    letters = []
    for i in range(num_columns):
        # Convertir el índice a letras de columna (0-indexed)
        letter = ""
        n = i
        while n >= 0:
            # Agregar la letra correspondiente al valor actual de n
            letter = chr(ord('A') + n % 26) + letter
            # Reducir n teniendo en cuenta que las letras de Excel son 1-indexed
            n = n // 26 - 1
        letters.append(letter)
    return letters

def _check_dv(nit):
    """
    Function to calculate the check digit (DV) of the NIT. So there is no
    need to type it manually.
    @param nit: Enter the NIT number without check digit
    @return: String
    """
    nitString = '0'*(15-len(nit)) + nit
    vl = list(nitString)
    result = (
        int(vl[0])*71 + int(vl[1])*67 + int(vl[2])*59 + int(vl[3])*53 +
        int(vl[4])*47 + int(vl[5])*43 + int(vl[6])*41 + int(vl[7])*37 +
        int(vl[8])*29 + int(vl[9])*23 + int(vl[10])*19 + int(vl[11])*17 +
        int(vl[12])*13 + int(vl[13])*7 + int(vl[14])*3
    ) % 11

    if result in (0, 1):
        return str(result)
    else:
        return str(11-result)